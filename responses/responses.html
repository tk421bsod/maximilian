<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="../common.js"></script>
    <title>Maximilian Web Interface (WIP)</title>
    <link rel="stylesheet" href="../common.css">
</head>
<body>
<h1>This is the web interface for Maximilian.</h1>
<br>
<p>This is a very early beta, so don't expect it to work perfectly. DM me on Discord at tk421#7244, or send an email to <a href="mailto:xtk421bsodx@gmail.com">xtk421bsodx@gmail.com</a> if you have any feedback, feature request, bug reports, or questions.</p>
<br>
<br>
<p id="error"></p>
<p id="technicalinfo" style="opacity:0;height:0;"></p>
<button id="technicalinfobutton" style="opacity:0; padding:0.5% 2.5% 0.5% 2.5%;" onclick=showtechnicalinfo();></button>

<br>
<br>
<input type="text" id="guild_id" name="guild_id" placeholder="Enter the ID of the server you want to create the custom response for.">
<br>
<br>
<input type="text" id="response_trigger" name="response_trigger" placeholder="Enter what will trigger the response.">
<br>
<br>
<input type="text" id="response_text" name="response_text" placeholder="Enter the text that the bot should send.">
<br>
<br>
<button id="saveresponse" onclick=save(path,database,table,valuenodupe,valueallnum,valueallnumenabled,debug);>Save Response</button>
<br>
<p id="saving"></p>
<script>
//initialize variables
const path = "responses";
const database = "maximilian";
const table = "responses";
const valuenodupe = "response_trigger";
const valueallnum = "guild_id"
const valueallnumenabled = "True"
const debug = "";
//get url parameters
try {
    var sourceofredirect = getUrlParam('redirectsource','noredirect');
    var saveresponseState = getUrlParam('changessaved', '' );
    var errormessage = getUrlParam('error', '');
    if (sourceofredirect == "savechanges") {
    //depending on the result, show a different message
    if (saveresponseState == "successful"){document.getElementById("saving").innerHTML="Your custom response was saved successfully. Try testing it!";} 
    if (saveresponseState == "error-duplicate"){document.getElementById("error").innerHTML="Your custom response already exists. Try making a new one!";}
    //if the guild id is invalid
    if (saveresponseState == "error-guildid-invalid"){        
        document.getElementById("error").innerHTML = "It looks like the server ID isn't valid. Make sure you entered everything in the correct fields, and check the server ID for typos. Remember, the server ID is not the server's name.";
        document.getElementById("guild_id").style.transition = "0.0s";
        document.getElementById("guild_id").style.webkitTransition = "0.0s";
        document.getElementById("guild_id").style.border = "10px solid red";
        document.getElementById("guild_id").focus;}
    //if there's a different error
    if (saveresponseState=="error-other"){
        if(errormessage != ""){
            console.error(errormessage);
            message = errormessage + ". This error was server-side, and it occurred in " + getUrlParam('errorlocation', '') + '.';
            displayError("saveresponse", message)
        }
    }
}
} catch (error) {
    console.error(error);
    message = error.message + ". This error was client-side, and it occurred in responses.html."
    displayError("saveresponse", message)
}
</script>
<br>
<footer>Made with ♥️ by TK421bsod</footer>    
</body>
</html>
